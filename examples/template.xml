<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="" version="2.6">

	<map name="Uniform" >beast.math.distributions.Uniform</map>
	<map name="Exponential" >beast.math.distributions.Exponential</map>
	<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
	<map name="Normal" >beast.math.distributions.Normal</map>
	<map name="Beta" >beast.math.distributions.Beta</map>
	<map name="Gamma" >beast.math.distributions.Gamma</map>
	<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
	<map name="prior" >beast.math.distributions.Prior</map>
	<map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
	<map name="OneOnX" >beast.math.distributions.OneOnX</map>
	<map name="Dirichlet" >beast.math.distributions.Dirichlet</map>


	<!-- Alignment sampler -->
	<data id="alignment.$(partition)" spec="xmlsimulator.DatasetSampler">
		<!--<file spec="xmlsimulator.WeightedFile" file="../datasets/Becker_2016/alignment.nex" desc="Benchmark data by Becker 2016"/>-->
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Anderson_2013/alignment.nex" desc="Benchmark data by Anderson 2013"/>
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Cognato_2001/alignment.nex" desc="Benchmark data by Cognato 2001"/>


		<!-- Do not repeat $(partition) across all partitions in these elements. Just use the first partition -->
		<norepeat>tree.taxonset NJtree</norepeat>

	</data>


	<!-- Placeholder site model -->
	<siteModel id="siteModel.t:$(partition)" spec="SiteModel" gammaCategoryCount="1">
		<parameter spec="parameter.RealParameter" estimate="false" name="mutationRate">1.0</parameter>
		<parameter spec="parameter.RealParameter" estimate="false" name="shape">1.0</parameter>
		<substModel spec="JukesCantor" />
	</siteModel>


	<!-- Placeholder clock model -->
  	<branchRateModel id="ClockModel.t:$(partition)" spec="beast.evolution.branchratemodel.StrictClockModel">
			<parameter id="ucldMean.c:$(partition)" estimate="false" name="clock.rate">1.0</parameter>
    </branchRateModel>


	<run id="XMLSimulator" spec="xmlsimulator.SimulateXML" xml="out.xml" data="@alignment.$(partition)">



		


		<!-- Site model sampler -->
		<model id="siteModelSampler" spec="xmlsimulator.ModelSampler">
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/JukesCantor.xml" desc="The Jukes-Cantor site model" />
			<!--
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/HKY.xml" desc="The HKY site model" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/HKYf.xml" desc="The HKY site model with estimated frequencies" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/GTR.xml" desc="The GTR site model" />
		-->
		</model>
		

		<!-- Tree prior sampler -->
		<model id="treeModelSampler" spec="xmlsimulator.ModelSampler">
			<file spec="xmlsimulator.WeightedFile" file="../models/tree/Yule.xml" desc="A Yule tree prior" />
			<file spec="xmlsimulator.WeightedFile" file="../models/tree/Coalescent.xml" desc="A coalescent tree prior" />
		</model>
	
		<runner id="mcmc" spec="beast.core.MCMC"  chainLength="50000000">
		

			<init spec="beast.util.ClusterTree" id="NJtree" initial="@tree" clusterType="neighborjoining" taxa="@alignment.$(partition)"/>
		

			<state id="state" spec="State" storeEvery="1000">

				<tree id="tree" spec="beast.evolution.tree.Tree" name="stateNode">
					<taxonset id="tree.taxonset" spec="TaxonSet" alignment="@alignment.$(partition)" />
				</tree>

				
				<parameter spec="parameter.RealParameter" id="clockRate.t:$(partition)" name="stateNode">1.0</parameter>

			</state>


			<distribution id="posterior" spec="util.CompoundDistribution">



				<distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">

				
						<distribution id="treeLikelihood.$(partition)" spec="TreeLikelihood" tree="@tree" data="@alignment.$(partition)" siteModel="@siteModel.t:$(partition)" branchRateModel="@ClockModel.t:$(partition)">
						    <!--<data spec="FilteredAlignment" data="@benchmark" filter="1-649"/>-->
						    

						  
						</distribution>

				</distribution>


				<distribution id="prior" spec="util.CompoundDistribution">



					<prior id="clockRatePrior.t:$(partition)" name="distribution" x="@clockRate.t:$(partition)">
						<LogNormal name="distr" meanInRealSpace="true">
							<parameter spec="parameter.RealParameter" estimate="false" name="M">1.0</parameter>
							<parameter spec="parameter.RealParameter" estimate="false" name="S">0.6</parameter>
						</LogNormal>
					</prior>

				</distribution>


			</distribution>


			
			<operator id="TreeScaler.t:tree" spec="ScaleOperator" scaleFactor="0.5" tree="@tree" weight="3.0"/>
			<operator id="TreeRootScaler.t:tree" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree" weight="3.0"/>
			<operator id="UniformOperator.t:tree" spec="Uniform" tree="@tree" weight="30.0"/>
			<operator id="SubtreeSlide.t:tree" spec="SubtreeSlide" tree="@tree" weight="15.0"/>
			<operator id="Wide.t:tree" spec="Exchange" isNarrow="false" tree="@tree" weight="3.0"/>
			<operator id="WilsonBalding.t:tree" spec="WilsonBalding" tree="@tree" weight="3.0"/>






			<operator id="ClockRateExchanger" spec="BactrianDeltaExchangeOperator" delta="0.01" weight="0.4">
				<kernelDistribution spec="beast.evolution.operators.KernelDistribution$Bactrian" m="0.95" mode="uniform"/>
				<parameter idref="clockRate.t:$(partition)"/>
			</operator>


			<logger id="screenlog" spec="Logger" logEvery="10000">
				<log idref="posterior"/>
			</logger>



			<logger id="tracelog" fileName="$(filebase).log" spec="Logger" logEvery="1000">
				<log idref="posterior"/>
				<log idref="likelihood"/>
				<log idref="prior"/>
				<log id="TreeHeight.t:benchmark" spec="beast.evolution.tree.TreeStatLogger" tree="@tree"/>
			</logger>

			
		</runner>

		

		


		<!--
		<distribution id="treeLikelihood.$(partition)" spec="TreeLikelihood" tree="@tree">
			<data spec="FilteredAlignment" data="@benchmark" filter="1-649"/>
			<siteModel idref="siteModel.$(partition)" />
			<branchRateModel idref="clockModel" />
		</distribution>
		-->
		
		
		<logger spec="xmlsimulator.XMLSimulatorLogger" fileName="xmlsimulator.log" />


	</run>

</beast>







