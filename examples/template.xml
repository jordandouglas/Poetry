<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="" version="2.6">

	<map name="Uniform" >beast.math.distributions.Uniform</map>
	<map name="Exponential" >beast.math.distributions.Exponential</map>
	<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
	<map name="Normal" >beast.math.distributions.Normal</map>
	<map name="Beta" >beast.math.distributions.Beta</map>
	<map name="Gamma" >beast.math.distributions.Gamma</map>
	<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
	<map name="prior" >beast.math.distributions.Prior</map>
	<map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
	<map name="OneOnX" >beast.math.distributions.OneOnX</map>
	<map name="Dirichlet" >beast.math.distributions.Dirichlet</map>



	<!-- Alignment sampler -->
	<data id="alignment.$(partition)" spec="xmlsimulator.DatasetSampler">

		<file spec="xmlsimulator.WeightedFile" file="../datasets/Becker_2016.tar.gz/Becker_2016/alignment.nex" desc="Benchmark alignment"  />
		<file weight="10000" spec="xmlsimulator.WeightedFile" file="../datasets/Murray_2013.tar.gz/Murray_2013/alignment.nex" desc="Benchmark alignment" species="3,4" split="_" />

		<!--
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Anderson_2013.tar.gz/Anderson_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Ballesteros_2019.tar.gz/Ballesteros_2019/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Becker_2016.tar.gz/Becker_2016/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Bergsten_2013.tar.gz/Bergsten_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Borowiec_2015.tar.gz/Borowiec_2015/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Branstetter_2017.tar.gz/Branstetter_2017/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Broughton_2013.tar.gz/Broughton_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Brown_2012.tar.gz/Brown_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Cannon_2016_aa.tar.gz/Cannon_2016_aa/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Cannon_2016_dna.tar.gz/Cannon_2016_dna/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Chen_2015.tar.gz/Chen_2015/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Cognato_2001.tar.gz/Cognato_2001/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Crawford_2012.tar.gz/Crawford_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Day_2013.tar.gz/Day_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Devitt_2013.tar.gz/Devitt_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Dornburg_2012.tar.gz/Dornburg_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Faircloth_2013.tar.gz/Faircloth_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Fong_2012.tar.gz/Fong_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Horn_2014.tar.gz/Horn_2014/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Kawahara_2013.tar.gz/Kawahara_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Lartillot_2012.tar.gz/Lartillot_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Leache_2015.tar.gz/Leache_2015/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Looney_2016.tar.gz/Looney_2016/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/McCormack_2013.tar.gz/McCormack_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Meiklejohn_2016.tar.gz/Meiklejohn_2016/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Misof_2014.tar.gz/Misof_2014/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Moyle_2016.tar.gz/Moyle_2016/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Murray_2013.tar.gz/Murray_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Near_2013.tar.gz/Near_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016a.tar.gz/Nguyen_2016a/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016b.tar.gz/Nguyen_2016b/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016c.tar.gz/Nguyen_2016c/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016d.tar.gz/Nguyen_2016d/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016e.tar.gz/Nguyen_2016e/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Nguyen_2016f.tar.gz/Nguyen_2016f/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Oaks_2011.tar.gz/Oaks_2011/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Prebus_2017.tar.gz/Prebus_2017/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Pyron_2011.tar.gz/Pyron_2011/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Ran_2018_aa.tar.gz/Ran_2018_aa/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Ran_2018_dna.tar.gz/Ran_2018_dna/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Reddy_2017.tar.gz/Reddy_2017/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Richart_2015.tar.gz/Richart_2015/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Rightmyer_2013.tar.gz/Rightmyer_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Sauquet_2011.tar.gz/Sauquet_2011/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Seago_2011.tar.gz/Seago_2011/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Sharanowski_2011.tar.gz/Sharanowski_2011/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Siler_2013.tar.gz/Siler_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Smith_2014.tar.gz/Smith_2014/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Tolley_2013.tar.gz/Tolley_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Unmack_2013.tar.gz/Unmack_2013/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Varga_2019.tar.gz/Varga_2019/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Wainwright_2012.tar.gz/Wainwright_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Whelan_2017.tar.gz/Whelan_2017/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Wood_2012.tar.gz/Wood_2012/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014a.tar.gz/Worobey_2014a/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014b.tar.gz/Worobey_2014b/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014c.tar.gz/Worobey_2014c/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014d.tar.gz/Worobey_2014d/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014e.tar.gz/Worobey_2014e/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014f.tar.gz/Worobey_2014f/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014g.tar.gz/Worobey_2014g/alignment.nex" desc="Benchmark alignment" />
		<file spec="xmlsimulator.WeightedFile" file="../datasets/Worobey_2014h.tar.gz/Worobey_2014h/alignment.nex" desc="Benchmark alignment" />
		-->


		<!-- Do not repeat $(partition) across all partitions in these elements. Just use the first partition -->
		<norepeat>tree.taxonset NJtree</norepeat>

	</data>


	<!-- Placeholder site model -->
	<siteModel id="siteModel.t:$(partition)" spec="SiteModel" gammaCategoryCount="1">
		<parameter spec="parameter.RealParameter" estimate="false" name="mutationRate">1.0</parameter>
		<parameter spec="parameter.RealParameter" estimate="false" name="shape">1.0</parameter>
		<substModel spec="JukesCantor" />
	</siteModel>


	<!-- Placeholder clock model -->
  	<branchRateModel id="ClockModel.t:tree" spec="beast.evolution.branchratemodel.StrictClockModel">
			<parameter estimate="false" name="clock.rate">1.0</parameter>
    </branchRateModel>


	<run id="XMLSimulator" spec="xmlsimulator.SimulateXML" xml="out.xml" data="@alignment.$(partition)">




		<!-- XML functions -->
		<function id="dnaOnly" spec="xmlsimulator.XMLCondition" obj="@alignment.$(partition)" method="isDNA" />
		<function id="aaOnly" spec="xmlsimulator.XMLCondition" obj="@alignment.$(partition)" method="isAminoAcid" />
		<function id="speciesOnly" spec="xmlsimulator.XMLCondition" obj="@alignment.$(partition)" method="hasSpeciesMap" />
		<function id="notSpeciesOnly" spec="xmlsimulator.XMLCondition" obj="@alignment.$(partition)" method="hasSpeciesMap" negate="true" />
		<function id="doingMSCAnalysis" spec="xmlsimulator.XMLCondition" obj="@MSCWeightedFile" method="wasSampled" />
		<function id="doingConcatAnalysis" spec="xmlsimulator.XMLCondition" obj="@ConcatWeightedFile" method="wasSampled" />
		<function id="mscTaxonSet" spec="xmlsimulator.XMLPopulator" obj="@alignment.$(partition)" method="getMSCTaxonSet" />


		<!-- Species model sampler -->
		<model id="speciesModelSampler" spec="xmlsimulator.ModelSampler">
			<file id="ConcatWeightedFile" spec="xmlsimulator.WeightedFile" file="../models/species/Concat.xml" desc="Loci are concatenated (as partitions)" />
			<file weight="10000" id="MSCWeightedFile" spec="xmlsimulator.WeightedFile" file="../models/species/MSC.xml" desc="Loci are treated as gene trees" condition="@speciesOnly" />
		</model>


		<!-- Site model sampler -->
		<model id="siteModelSampler" spec="xmlsimulator.ModelSampler">

			<!-- Nucleotide -->
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/JukesCantor.xml" desc="The Jukes-Cantor site model" condition="@dnaOnly" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/HKY.xml" desc="The HKY site model" condition="@dnaOnly" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/HKYf.xml" desc="The HKY site model with estimated frequencies" condition="@dnaOnly" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/nucleotide/GTR.xml" desc="The GTR site model" condition="@dnaOnly" />

			<!-- Amino acid -->
			<file spec="xmlsimulator.WeightedFile" file="../models/site/aminoacid/WAG.xml" desc="The WAG site model" condition="@aaOnly" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/aminoacid/Blosum62.xml" desc="The Blosum62 site model" condition="@aaOnly" />
			<file spec="xmlsimulator.WeightedFile" file="../models/site/aminoacid/MTREV.xml" desc="The MTREV site model" condition="@aaOnly" />
			
		</model>
		

		<!-- Clock model sampler -->
		<model id="clockModelSampler" spec="xmlsimulator.ModelSampler">
			<file spec="xmlsimulator.WeightedFile" file="../models/clock/Strict.xml" desc="The strict clock" condition="@doingConcatAnalysis" />
			<file spec="xmlsimulator.WeightedFile" file="../models/clock/RelaxedLN.xml" desc="A relaxed clock with lognormal prior" condition="@doingConcatAnalysis" />
			<file spec="xmlsimulator.WeightedFile" file="../models/clock/SB3RelaxedClock.xml" desc="Multispecies coalescent relaxed clock model with lognormal prior" condition="@doingMSCAnalysis" />
		</model>


		<!-- Tree prior sampler -->
		<model id="treeModelSampler" spec="xmlsimulator.ModelSampler">
			<file spec="xmlsimulator.WeightedFile" file="../models/tree/Yule.xml" desc="A Yule tree prior" />
			<file spec="xmlsimulator.WeightedFile" file="../models/tree/Coalescent.xml" desc="A coalescent tree prior" condition="@doingConcatAnalysis" />
		</model>



		
	
		<runner id="mcmc" spec="beast.core.MCMC"  chainLength="50000000">
		

			<state id="state" spec="State" storeEvery="1000">

				<tree id="tree" spec="beast.evolution.tree.Tree" name="stateNode">
					<taxonset id="tree.taxonset" spec="TaxonSet" alignment="@alignment.$(partition)" />
				</tree>
				<parameter spec="parameter.RealParameter" id="clockRate.t:$(partition)" name="stateNode">1.0</parameter>

			</state>


			<distribution id="posterior" spec="util.CompoundDistribution">



				<distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">
						<distribution id="treeLikelihood.$(partition)" spec="TreeLikelihood" tree="@tree" data="@alignment.$(partition)" siteModel="@siteModel.t:$(partition)" branchRateModel="@ClockModel.t:tree" />
				</distribution>


				<distribution id="prior" spec="util.CompoundDistribution">



					<prior id="clockRatePrior.t:$(partition)" name="distribution" x="@clockRate.t:$(partition)">
						<LogNormal name="distr" meanInRealSpace="true">
							<parameter spec="parameter.RealParameter" estimate="false" name="M">1.0</parameter>
							<parameter spec="parameter.RealParameter" estimate="false" name="S">0.6</parameter>
						</LogNormal>
					</prior>

				</distribution>


			</distribution>


			
			<operator id="TreeScaler.t:tree" spec="ScaleOperator" scaleFactor="0.5" tree="@tree" weight="3.0"/>
			<operator id="TreeRootScaler.t:tree" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@tree" weight="3.0"/>
			<operator id="UniformOperator.t:tree" spec="Uniform" tree="@tree" weight="30.0"/>
			<operator id="SubtreeSlide.t:tree" spec="SubtreeSlide" tree="@tree" weight="15.0"/>
			<operator id="Wide.t:tree" spec="Exchange" isNarrow="false" tree="@tree" weight="3.0"/>
			<operator id="Narrow.t:tree" spec="Exchange" isNarrow="true" tree="@tree" weight="3.0"/>
			<operator id="WilsonBalding.t:tree" spec="WilsonBalding" tree="@tree" weight="3.0"/>




			<operator id="ClockRateExchanger" spec="BactrianDeltaExchangeOperator" delta="0.01" weight="0.4">
				<kernelDistribution spec="beast.evolution.operators.KernelDistribution$Bactrian" m="0.95" mode="uniform"/>
				<parameter idref="clockRate.t:$(partition)"/>
			</operator>


			<logger id="screenlog" spec="Logger" logEvery="1000">
				<log idref="posterior"/>
			</logger>



		    <logger id="treeLogger" fileName="$(filebase).trees" logEvery="10000" mode="tree">
		    	<log spec="beast.evolution.tree.TreeWithMetaDataLogger" branchratemodel="@ClockModel.t:tree" tree="@tree"/>
			</logger>



			<logger id="tracelog" fileName="$(filebase).log" spec="Logger" logEvery="10000">
				<log idref="posterior"/>
				<log idref="likelihood"/>
				<log idref="prior"/>
				<log id="TreeStat.t:tree" spec="beast.evolution.tree.TreeStatLogger" tree="@tree"/>
				
				<log idref="clockRate.t:$(partition)"/>
			</logger>

			
		</runner>

		

		


		<!--
		<distribution id="treeLikelihood.$(partition)" spec="TreeLikelihood" tree="@tree">
			<data spec="FilteredAlignment" data="@benchmark" filter="1-649"/>
			<siteModel idref="siteModel.$(partition)" />
			<branchRateModel idref="clockModel" />
		</distribution>
		-->
		
		
		<logger spec="xmlsimulator.XMLSimulatorLogger" fileName="xmlsimulator.log" />


	</run>

</beast>







